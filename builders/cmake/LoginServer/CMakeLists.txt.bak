FILE(GLOB_RECURSE SOURCES ${PROJECT_SOURCE_DIR}/src/LoginServer/*.cpp)

FILE(GLOB COMMON_PROTO ${PROJECT_SOURCE_DIR}/src/Proto/*.proto)

FOREACH(PROTO_FILE ${COMMON_PROTO}) 
	STRING(REGEX REPLACE ".proto$" "" PROTO_FILE_WE ${PROTO_FILE})
	STRING(REGEX REPLACE "/Proto" "/Proto/Imp" PROTO_FILE_IMP_WE ${PROTO_FILE_WE})

	LIST(APPEND PROTO_SOURCE "${PROTO_FILE_IMP_WE}.pb.cc")

	ADD_CUSTOM_COMMAND(
		OUTPUT "${PROTO_FILE_IMP_WE}.pb.h" "${PROTO_FILE_IMP_WE}.pb.cc" 
		COMMAND  ${PROTOBUFF_BIN} ARGS --cpp_out ${PROTO_PATH}/Imp --proto_path ${PROTO_PATH} ${PROTO_FILE} 
		DEPENDS ${PROTO_FILE}
	)
ENDFOREACH(PROTO_FILE)

INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR}/src ${COMMON_PATH} ${BASE_PATH} ${GEN_PATH} ${3PARTY_INC} ${PROTO_IMP_PATH} ${SHARED_PATH} ${GAMESHARED_PATH})

ADD_EXECUTABLE(LoginServer ${SOURCES} ${PROTO_SOURCE})

TARGET_LINK_LIBRARIES(LoginServer ${PROJECT_SOURCE_DIR}/lib/libGameShared.a ${PROJECT_SOURCE_DIR}/lib/libshared.a ${PROJECT_SOURCE_DIR}/lib/libbase.a ${UV_LIB} ${PROTOBUF_LIB})

SET(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin/)

